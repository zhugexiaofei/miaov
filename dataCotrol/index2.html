<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>数据操作+弹出层提示</title>
<link href="css.css" rel="stylesheet" type="text/css" />
<script src="data.js"></script>
<script>
window.onload = function(){

var tab = new Tab();
tab.init();


function Tab(){
   this.oHeader = document.getElementById('header');
   this.oListContent = document.getElementById('listContent');
   this.oTips = document.getElementById('tips');
   this.oTipsContent = document.getElementById('tipsContent');
   this.data = data;
   this.index = 0;
}

Tab.prototype.init = function(){
	var This = this;
	//生成一级标题
	for(var i = 0 ; i<this.data.length;i++){
	   var oLi = document.createElement('li');
	   oLi.setAttribute('indexId',i)
	   oLi.innerHTML = data[i].name;
	   this.oHeader.appendChild( oLi );	
    }
	//添加默认样式和显示内容列表
	this.oHeader.children[this.index].className = 'focus';
	this.addTitle(this.index);
	this.showTip(this.index);
	
	this.oHeader.onclick = function(e){
		var e = e || window.event;
		var thisNode=e.target.nodeName.toLocaleLowerCase();
		var thisObj;
		if(thisNode == 'li' ){
			thisObj = e.target;
			//先清空再赋值
			This.oHeader.children[This.index].className = '';
			
			This.index = thisObj.getAttribute('indexId');
			This.oHeader.children[This.index].className = 'focus';
	        This.addTitle(This.index);
	        This.showTip(This.index);
		}
	}
}
//Tab
//获取列表内容标题
Tab.prototype.addTitle = function( index ){
	var oUl = document.createElement('ul');
	for(var i = 0;i<this.data[index].list.length;i++){
		var oLi = document.createElement('li');
		oLi.setAttribute('tabindex',i)
		oLi.innerHTML = '<a href="javascript:;">' + this.data[index].list[i].title + '</a>';
		oUl.appendChild( oLi );
	}
	this.oListContent.innerHTML = '';
	oUl.className = 'list';
	this.oListContent.appendChild(oUl);
}
//获取元素位置
Tab.prototype.getPos = function(obj){
	var pos = {
		left:0,
		top:0
	};
	while(obj){
		pos.left += obj.offsetLeft;
		pos.top += obj.offsetTop;
		obj = obj.offsetParent;
	};
	return pos;
}
//添加列表内容鼠标滑入滑出事件
//idIndex  传入的data索引
Tab.prototype.showTip = function( idIndex ){
	var This = this;
	//滑入显示
	this.oListContent.onmousemove = function(e){
		var e = e || window.event;
		var thisNode=e.target.nodeName.toLocaleLowerCase(),
		    thisObj,
		    listIndex;
		if(thisNode == 'a' ){
			thisObj= e.target ;
			listIndex=thisObj.parentNode.getAttribute('tabindex');
			This.addTipContent(idIndex,listIndex);
			
			This.oTips.style.left = (This.getPos(thisObj).left+thisObj.offsetWidth+11)+'px';
			This.oTips.style.top = (This.getPos(thisObj).top-112)+'px';
			This.oTips.style.display = 'block';
		}
	}
	//移出隐藏
	this.oListContent.onmouseout = function(){
		 This.oTips.style.display = 'none';
	}
}
//生成弹出窗内容的方法
Tab.prototype.addTipContent = function( m, n ){
	
	this.oTipsContent.innerHTML = '';
	var oUl = document.createElement('ul');
	var str = '<li><h2>'+data[m].list[n].company+'</h2></li>'
	           +'<li class="col" <span style="font-weight: bold">职位：</span><span>'+data[m].list[n].position+'</span></li>'
	           +'<li class="col" <span style="font-weight: bold">招聘人数：</span><span>'+data[m].list[n].recruitingNumbers+'</span></li>'
	           +'<li class="col" <span style="font-weight: bold">工作地点：</span><span>'+data[m].list[n].workingLocation+'</span></li>'
	           +'<li class="col" <span style="font-weight: bold">工作经历：</span><span>'+data[m].list[n].workExperience+'</span></li>'
	           +'<li class="col" <span style="font-weight: bold">学历：</span><span>'+data[m].list[n].education+'</span></li>'
	           +'<li class="col" <span style="font-weight: bold">薪资：</span><span>'+data[m].list[n].wage+'</span></li>'
	           +'<li class="col" <span >时间：</span><span>'+data[m].list[n].addDate+'</span></li>';
	 oUl.innerHTML = str;
	 this.oTipsContent.appendChild( oUl );
}

}
</script>
</head>

<body>
	<div id="container">
		<ul id="header"></ul>
		
		<div id="listContent"></div>
	</div>
	
	<div id="tips">
		<span id="arrow"></span>
        <div id="tipsContent"></div>
	</div>
</body>
</html>